@(post : UserPost,histories : List[controllers.management.EditPost.UpdateHistory],
  form : Form[_],postUpdateForm : Form[_],sendPrivateMessageForm : Form[_],
  statusMessage : String, selections : controllers.management.EditPost.Selections)
@implicitFieldConstructor = @{ helper.FieldConstructor(views.html.twitterBootstrapInput.f) }

@scripts = {
<script type="text/javascript">
    $(document).ready(function() {
        var latLon = new google.maps.LatLng(@post.latitude.get, @post.longitude.get)
        var mapOptions = {
            center: latLon,
            zoom: 14,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);
        var marker = new google.maps.Marker({
            position: latLon,
            map: map,
            title: 'Here!'
        });
    })

</script>
}


@main("Top page1",scripts){

@if(statusMessage.length > 0){
    <div class="alert">@statusMessage</div>
}

<div class="row-fluid">

    <div class="span6">
    @helper.form(action = management.routes.EditPost.updatePostStatus(post.id.get),'class -> "form-horizontal"){
        @UIParts.labelInForm("postId","ID",post.id.get.toString)
        @UIParts.labelInForm("customer","問い合わせユーザー",post.postUser.obj.map(_.nickname.is).openOr("No name"))
        @UIParts.labelInForm("posted","投稿",post.posted.get.toString)
        @UIParts.labelInForm("comment","コメント",post.comment.get)


        @helper.select(form("category"),selections.categories)
        @helper.select(form("inCharge"),selections.managers)
        @helper.select(form("postStatus"),selections.postStatuses)

        @helper.textarea(postUpdateForm("comment"))

        <div class="control-group">
            <div class="controls">
            <input type="submit" value="更新"  class="btn"/>
            </div>
        </div>
    }
    <hr />
    <div>更新履歴</div>

        @for(h <- histories){
            <div class="well">
                <div class="badge">更新者</div><span>@h.editor.nickname.is</span>
                <div>@h.comment</div>
                <div>@h.action</div>
            </div>
        }


    <div>

    <hr />
        管理者からのコメント
    @helper.form(action = management.routes.EditPost.sendPrivateMessage(post.id.get),'class -> "form-horizontal"){

        @helper.textarea(sendPrivateMessageForm("adminComment"))

        <div class="control-group">
            <div class="controls">
                <input type="submit" value="管理者からのコメントを送る"  class="btn"/>
            </div>
        </div>

    }


    </div>


    </div>
    <div class="span6 map_area">
        <div id="map_canvas" style="width:100%; height:90%;"></div>
        <div class="well well-small">
            <span>位置情報</span>
            <span class="badge">緯度</span><span id="latitude">@post.latitude.get</span>
            <span class="badge">経度</span><span id="longitude">@post.longitude.get</span>
        </div>

        <img src="@routes.Application.photo(post.image.obj.get.fileKey.is)" style="width:100%;"/>

    </div>


</div>

}